<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Vyacheslav Lyubchich" />

<meta name="date" content="2025-12-05" />

<title>Tests for trends in time series</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Tests for trends in time series</h1>
<h4 class="author">Vyacheslav Lyubchich</h4>
<h4 class="date">2025-12-05</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#testing-for-presence-of-a-trend" id="toc-testing-for-presence-of-a-trend"><span class="toc-section-number">2</span> Testing for presence of a trend</a>
<ul>
<li><a href="#linear-trend" id="toc-linear-trend"><span class="toc-section-number">2.1</span> Linear trend</a></li>
<li><a href="#monotonic-trend" id="toc-monotonic-trend"><span class="toc-section-number">2.2</span> Monotonic trend</a></li>
<li><a href="#any-trend" id="toc-any-trend"><span class="toc-section-number">2.3</span> Any trend</a></li>
</ul></li>
<li><a href="#testing-a-specific-parametric-form-of-trend" id="toc-testing-a-specific-parametric-form-of-trend"><span class="toc-section-number">3</span> Testing a specific parametric form
of trend</a></li>
<li><a href="#citation" id="toc-citation">Citation</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The majority of studies focus on detection of linear or monotonic
trends, using</p>
<ul>
<li>classical t-test (for linear trends) or</li>
<li>rank-based Mann–Kendall test (for monotonic trends)</li>
</ul>
<p>typically under the assumption of uncorrelated data.</p>
<p>There exist two main problems:</p>
<ul>
<li>dependence effect, that is, the issue of inflating significance due
to dependent observations when the test is developed for independent
data (always check assumptions of the testing method!), and</li>
<li>change points or regime shifts that affect the linear or monotonic
trend hypothesis. For example, when testing the null hypothesis (<span class="math inline">\(H_0\)</span>) of no trend against the alternative
hypothesis (<span class="math inline">\(H_1\)</span>) of linear trend,
using t-test, it is easier to reject <span class="math inline">\(H_0\)</span> and accept <span class="math inline">\(H_1\)</span> in case A below, than in case B, and
especially hard to reject <span class="math inline">\(H_0\)</span> in
case C. Case C reminds us that a test with proper alternative hypothesis
should be chosen, and that non-rejection of <span class="math inline">\(H_0\)</span> does not mean it is true.</li>
</ul>
<p>These problems can be addressed by using tests for
<strong>non-monotonic trends</strong> assuming that <strong>observations
can be autocorrelated</strong>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">777</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>Time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ar =</span> <span class="fl">0.5</span>), <span class="at">n =</span> n, <span class="at">n.start =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>Time<span class="sc">/</span>n <span class="sc">+</span> X0</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(Time<span class="sc">/</span>n)<span class="sc">^</span><span class="fl">0.5</span> <span class="sc">+</span> X0</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fl">0.5</span><span class="sc">*</span>(Time <span class="sc">-</span> n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>n <span class="sc">-</span> <span class="dv">6</span><span class="sc">*</span>((Time <span class="sc">-</span> n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>n)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> X0</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(X0, X1, X2, X3))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>The time series above were simulated:<br />
A) <code>X1</code> with linear trend,<br />
B) <code>X2</code> with square root – nonlinear monotonic – trend,
and<br />
C) <code>X3</code> with quadratic – nonlinear non-monotonic –
trend,<br />
with stationary autocorrelated innovations <code>X0</code>: <span class="math inline">\(X0_t = 0.5X0_{t-1} + e_t\)</span>, where <span class="math inline">\(e_t \sim N(0, 0.5^2)\)</span>.</p>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Let’s test these time series using the functions from package
<code>funtimes</code>, using significance level <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>To install and load the package, run</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;funtimes&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(funtimes)</span></code></pre></div>
</div>
<div id="testing-for-presence-of-a-trend" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Testing for presence of
a trend</h1>
<p>Function <code>notrend_test</code> tests the null hypothesis of no
trend against different alternatives defined by the corresponding
tests.</p>
<div id="linear-trend" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Linear trend</h2>
<p>Consider the following pair of hypotheses<br />
<span class="math inline">\(H_0\)</span>: no trend<br />
<span class="math inline">\(H_1\)</span>: linear trend<br />
that can be tested specifically using t-test.</p>
<p>Assuming the time series may be autocorrelated (which is the usual
case with observational data), we apply sieve-bootstrap version of the
<strong>t-test</strong>, by adapting the approach of <span class="citation">Noguchi, Gel, and Duguay (2011)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">notrend_test</span>(X0)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#   Sieve-bootstrap Student&#39;s t-test for a linear trend</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># data:  X0</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># Student&#39;s t value = -2.6429, p-value = 0.098</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># alternative hypothesis: linear trend.</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># sample estimates:</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># $AR_order</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># [1] 1</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co"># $AR_coefficients</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#     phi_1 </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co"># 0.4212756</span></span></code></pre></div>
<p>The large <span class="math inline">\(p\)</span>-value correctly
indicates that there is not enough evidence to reject the hypothesis of
no trend in <code>X0</code> in favor of the alternative hypothesis of a
linear trend.</p>
<p>For the other time series, <span class="math inline">\(p\)</span>-values are reported below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">apply</span>(X[,<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">notrend_test</span>(x)<span class="sc">$</span>p.value)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#    X1    X2    X3 </span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># 0.000 0.002 0.858</span></span></code></pre></div>
<p>indicating that the null hypothesis of no trend could be rejected and
hypothesis of a linear trend could be accepted for <code>X1</code> and
<code>X2</code>. While <code>X3</code> has a trend (based on the way it
was simulated and the time series plot above), the alternative
hypothesis of a linear trend does not fit in this case, so the test for
linear trend (t-test) failed to reject the null hypothesis.</p>
</div>
<div id="monotonic-trend" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Monotonic trend</h2>
<p>Since a linear trend is also a monotonic trend, we may expect seeing
similar results when testing the following pair of hypotheses<br />
<span class="math inline">\(H_0\)</span>: no trend<br />
<span class="math inline">\(H_1\)</span>: monotonic trend<br />
using Mann–Kendall test.</p>
<p>Apply <strong>Mann–Kendall test</strong>, also with the
sieve-bootstrap enhancement for potentially autocorrelated data; <span class="math inline">\(p\)</span>-values are shown below:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">apply</span>(X, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">notrend_test</span>(x, <span class="at">test =</span> <span class="st">&quot;MK&quot;</span>)<span class="sc">$</span>p.value)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#    X0    X1    X2    X3 </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># 0.057 0.000 0.000 0.929</span></span></code></pre></div>
<p>indicating that the null hypothesis of no trend could be rejected and
hypothesis of a monotonic trend could be accepted for <code>X1</code>
and <code>X2</code>. For <code>X0</code> and <code>X3</code>, the null
hypothesis could not be rejected, because <code>X0</code> does not have
a trend, and <code>X3</code> has a trend that does not match the
alternative hypothesis.</p>
</div>
<div id="any-trend" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Any trend</h2>
<p>If the interest is in testing for any, potentially non-monotonic
trend, consider testing the following pair of hypotheses<br />
<span class="math inline">\(H_0\)</span>: no trend<br />
<span class="math inline">\(H_1\)</span>: any trend<br />
using local regression-based WAVK test <span class="citation">(Wang,
Akritas, and Van Keilegom 2008)</span>.</p>
<p>Apply <strong>WAVK test</strong>, also with the sieve-bootstrap
enhancement for potentially autocorrelated data:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">apply</span>(X, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">notrend_test</span>(x, <span class="at">test =</span> <span class="st">&quot;WAVK&quot;</span>, </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                                     <span class="at">factor.length =</span> <span class="st">&quot;adaptive.selection&quot;</span>)<span class="sc">$</span>p.value)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#    X0    X1    X2    X3 </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># 0.337 0.000 0.026 0.004</span></span></code></pre></div>
<p>The results indicate that WAVK test was correct in non-rejecting the
null hypothesis for <code>X0</code>, and correctly rejected it for the
time series with trends <code>X1</code>, <code>X2</code>, and
<code>X3</code>.</p>
<p><span class="citation">Lyubchich, Gel, and El-Shaarawi (2013)</span>
originally implemented <em>hybrid</em> bootstrap to this test statistic,
available from the <code>wavk_test</code> function described in the next
section.</p>
</div>
</div>
<div id="testing-a-specific-parametric-form-of-trend" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Testing a specific
parametric form of trend</h1>
<p>Function <code>wavk_test</code> is developed for the following
goodness-of-fit question <span class="citation">(Lyubchich, Gel, and
El-Shaarawi 2013)</span>:<br />
<span class="math inline">\(H_0\)</span>: trend is of form <span class="math inline">\(f(\theta,t)\)</span><br />
<span class="math inline">\(H_1\)</span>: trend is not of form <span class="math inline">\(f(\theta,t)\)</span><br />
where <span class="math inline">\(f\)</span> belongs to a known family
of smooth parametric functions, and <span class="math inline">\(\theta\)</span> are its parameters.</p>
<p><strong>Note</strong> Considering <span class="math inline">\(f(\theta,t)\)</span> being some polynomial
function, non-rejection of the null hypothesis means that function <span class="math inline">\(f(\theta,t)\)</span> or its simpler form
(lower-order polynomial) is sufficient for describing the trend in the
tested time series.</p>
<p><strong>Note</strong> The case of <span class="math inline">\(f(\theta,t) \equiv 0\)</span> corresponds to
testing for no trend (in other words, for a constant trend, same as in
the previous section), and the following code differs only in the type
of bootstrap used,</p>
<ul>
<li>sieve bootstrap in <code>notrend_test</code> (WAVK statistic is
calculated on original time series and simulated autoregressive series)
and</li>
<li>hybrid bootstrap in <code>wavk_test</code> (WAVK statistic is
calculated on time series after the trend <span class="math inline">\(f(\theta,t)\)</span> and autoregressive dependence
are removed, and on simulated independent normal series)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">notrend_test</span>(X0, <span class="at">test =</span> <span class="st">&quot;WAVK&quot;</span>, <span class="at">factor.length =</span> <span class="st">&quot;adaptive.selection&quot;</span>) <span class="co"># WAVK with sieve bootstrap</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#   Sieve-bootstrap WAVK trend test</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># data:  X0</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># WAVK test statistic = 8.7024, moving window = 4, p-value = 0.37</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co"># alternative hypothesis: (non-)monotonic trend.</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># sample estimates:</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># $AR_order</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co"># [1] 1</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co"># $AR_coefficients</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#     phi_1 </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co"># 0.4212756</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="fu">wavk_test</span>(X0 <span class="sc">~</span> <span class="dv">0</span>, <span class="at">factor.length =</span> <span class="st">&quot;adaptive.selection&quot;</span>) <span class="co"># WAVK with hybrid bootstrap</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#   Trend test by Wang, Akritas, and Van Keilegom (bootstrap p-values)</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co"># data:  X0 </span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co"># WAVK test statistic = 0.30965, adaptively selected window = 4, p-value</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co"># = 0.632</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co"># alternative hypothesis: trend is not of the form X0 ~ 0.</span></span></code></pre></div>
<p>To test a linear trend <span class="math inline">\(f(\theta,t) =
\theta_0 + \theta_1 t\)</span>, use</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">wavk_test</span>(X0 <span class="sc">~</span> t, <span class="at">factor.length =</span> <span class="st">&quot;adaptive.selection&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#   Trend test by Wang, Akritas, and Van Keilegom (bootstrap p-values)</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co"># data:  X0 </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co"># WAVK test statistic = -0.085378, adaptively selected window = 4,</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># p-value = 0.98</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co"># alternative hypothesis: trend is not of the form X0 ~ t.</span></span></code></pre></div>
<p>Note that the time sequence <code>t</code> is specified automatically
within the function.</p>
<p>For the other time series, <span class="math inline">\(p\)</span>-values are shown below:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">apply</span>(X[,<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">wavk_test</span>(x <span class="sc">~</span> t, <span class="at">factor.length =</span> <span class="st">&quot;adaptive.selection&quot;</span>)<span class="sc">$</span>p.value)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#    X1    X2    X3 </span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co"># 0.954 0.786 0.020</span></span></code></pre></div>
<p>The function <code>poly</code> could also be used, for example, test
quadratic trend <span class="math inline">\(f(\theta,t) = \theta_0 +
\theta_1 t + \theta_2 t^2\)</span> and show the trend estimates using
the argument <code>out = TRUE</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">wavk_test</span>(X3 <span class="sc">~</span> <span class="fu">poly</span>(t, <span class="dv">2</span>), <span class="at">factor.length =</span> <span class="st">&quot;adaptive.selection&quot;</span>, <span class="at">out =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#   Trend test by Wang, Akritas, and Van Keilegom (bootstrap p-values)</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># data:  X3 </span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># WAVK test statistic = -0.097613, adaptively selected window = 4,</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># p-value = 0.896</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># alternative hypothesis: trend is not of the form X3 ~ poly(t, 2).</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># sample estimates:</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co"># $trend_coefficients</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co"># (Intercept) poly(t, 2)1 poly(t, 2)2 </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#  -0.4860421  -0.2358495  -4.7102192 </span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co"># $AR_order</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co"># [1] 1</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co"># $AR_coefficients</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#     phi_1 </span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co"># 0.4193298 </span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co"># $all_considered_windows</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#  Window WAVK-statistic p-value</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#       4    -0.09761277   0.896</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#       5    -0.47737630   0.816</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#       7    -0.47880434   0.860</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#      10    -0.12694875   0.780</span></span></code></pre></div>
</div>
<div id="citation" class="section level1 unnumbered">
<h1 class="unnumbered">Citation</h1>
<p>This vignette belongs to R package <code>funtimes</code>. If you wish
to cite this page, please cite the package:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">&quot;funtimes&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># To cite package &#39;funtimes&#39; in publications use:</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#   Lyubchich V, Gel Y, Vishwakarma S (2025). _funtimes: Functions for</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#   Time Series Analysis_. R package version 10.0.</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co"># A BibTeX entry for LaTeX users is</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#   @Manual{,</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#     title = {funtimes: Functions for Time Series Analysis},</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#     author = {Vyacheslav Lyubchich and Yulia R. Gel and Srishti Vishwakarma},</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#     year = {2025},</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#     note = {R package version 10.0},</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#   }</span></span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Lyubchich_etal_2013_wavk" class="csl-entry">
Lyubchich, V., Y. R. Gel, and A. El-Shaarawi. 2013. <span>“On Detecting
Non-Monotonic Trends in Environmental Time Series: A Fusion of Local
Regression and Bootstrap.”</span> <em>Environmetrics</em> 24 (4):
209–26. <a href="https://doi.org/10.1002/env.2212">https://doi.org/10.1002/env.2212</a>.
</div>
<div id="ref-Noguchi_etal_2011" class="csl-entry">
Noguchi, K., Y. R. Gel, and C. R. Duguay. 2011. <span>“Bootstrap-Based
Tests for Trends in Hydrological Time Series, with Application to Ice
Phenology Data.”</span> <em>Journal of Hydrology</em> 410 (3): 150–61.
<a href="https://doi.org/10.1016/j.jhydrol.2011.09.008">https://doi.org/10.1016/j.jhydrol.2011.09.008</a>.
</div>
<div id="ref-Wang_etal_2008" class="csl-entry">
Wang, L., M. G. Akritas, and I. Van Keilegom. 2008. <span>“An
<span>ANOVA</span>-Type Nonparametric Diagnostic Test for
Heteroscedastic Regression Models.”</span> <em>Journal of Nonparametric
Statistics</em> 20 (5): 365–82.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
